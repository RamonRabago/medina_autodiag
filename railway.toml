# Config as Code - Railway
# https://docs.railway.app/reference/config-as-code

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

# Migraciones: preDeployCommand corre ANTES de arrancar (fase separada, no bloquea).
# NO poner alembic en startCommand: bloqueaba el arranque (ver RAILWAY_LECCIONES_APRENDIDAS.md).
[deploy]
preDeployCommand = ["alembic", "upgrade", "head"]
startCommand = '/bin/sh -c "exec uvicorn app.main:app --host 0.0.0.0 --port ${PORT:-8000}"'
